---
title:  "[Statistics] Null Hypothesis & Alternative Hypothesis"
excerpt: "statistical hypothesis test"

categories:
  - Statistics
tags:
  - Statistics
toc: true
toc_sticky: true
last_modified_at: 2025-01-19T08:06:00-05:00
---

> 데이터 사이언티스트 되기 책: https://recipesds.tistory.com/


# hypothesis test

가설검정은 관심을 가지고 있는 모집단에 대한 가설을 세우고, 표본을 뽑아서 표본정보로부터 그 가설들을 검증하는 것을 의미한다. 

신뢰수준(구간)은 모수가 포함된 구간의 확률이고, 유의수준은 신뢰수준을 제외한 나머지 Extreme 영역을 말한다. 유의수준은 보통 $\alpha%$로 
표기하는데, 만약 신뢰수준이 95%라면, 유의수준은 5%가 된다. 유의수준(Significant Level)을 양쪽 구간으로 따질 때는 유의수준을 둘로 나눠서 
양측 검정($\alpha/2$)을하고, 한쪽만 따질 때는 나누지 않고 단측검정을 한다. 

<p align="center"><img src="https://github.com/user-attachments/assets/6e09b6fd-2574-44a0-833c-375c0ec4d274" height="50%" width="50%"></p>

1. 귀무가설의 분포
2. 귀무가설의 95% 신뢰구간
3. 귀무가설의 채택역
4. 귀무가설의 기각역
5. 유의수준 ($\alpha/2$)

## Null Hypothesis & Alternative Hypothesis

가설검정을 위해서 Null Hypothesis(귀무가설 $H_0$), Alternative Hypothesis(대립가설, $H_1$)을 설정해야 한다. 
Null Hypothesis는 검정의 대상이며 어떤 확률분포(모수)를 가정하고, 그 조건에서 해당 확률분포에 따라 어떤 관측이 무작위로 관측될 것이라는 가설이다. 
Alternative Hypothesis는 실체가 없이, 관찰해보니 가정한 확률분포가 아닌 것 같을 때 Null Hypothesis를 기각하고 채택되며 검정의 대상이 아니다. 
Null Hypothesis는 확률분포가 어떻다고 가정했을 뿐이지 이 가설이 무조건 참인 것은 아니다. 

예를 들어 다음과 같이 두 가설이 있다고 하자. 

$$\begin{align}
\mu &= 100 \cdots (1) \\  
\mu &\neq 100 \cdots (2)
\end{align}$$

$\sigma$를 안다는 가정하에 평균 $\mu$로 분포를 가정할 수 있는 가설은 (1)이다. (2)로는 분포를 표현할 수 없으며 실체가 없고, (1)을 부정할 뿐이다. 따라서 (1)이 귀무가설(Null Hypothesis)이 되고, (2)가 대립가설(Alternative Hypothesis)이 된다. 이러한 경우 검정을 할 때는 양측검정을 한다. 

다른 예로 다음과 같은 두 가설이 있다고 하자. 

$$\begin{align}
\mu &\ge 100 \cdots (3) \\  
\mu &< 100 \cdots (4)
\end{align}$$

이 경우 (3)은 $=$을 이용해 분포를 가정하고, 그 가정한 분포에서 $\mu > 1000$을 기본 채택역으로 정하여 $\mu < 100$에 기각역이 있도록 할 수 있지만, (4)로는 분포를 표현할 수 없다. 따라서 (3)이 Null Hypothesis이 된다. 이러한 가설의 경우 Null Hypothesis를 검정할 때는 단측검정을 한다. 

(1)(2) 가설의 경우 양측검정을 하므로 채택역이 95%라면 기각역은 5%를 반으로 나눠 2.5%씩 기각역이 되고 (3)(4)가설의 경우 단측검정이므로 한쪽의 5%가 기각역이 된다. 

다음의 정의는 귀무가설과 대립가설에 대하여 공부할 때 헷갈리게 하는 정의들이다. 

1. 귀무가설은 검정전과 검정 후가 다르지 않은 것을 귀무가설로 한다. 그러니까, 의미 없는 행위를 하는 것이므로 귀무가설은 기각되는 것이 좋다. (X)
2. 귀무가설이란 관습적이고 보수적인 주장, 차이가 없다, 0이다 등의  연구자가 타파하고자 하는 주장을 말하고, 대립가설이란 우리가 적극적으로 입증하려는 주장, 차이가 있음을 통계적 근거를 통해 입증하고자 하는 주장을 말한다. (X)
3. 귀무가설은 무죄추정의 원칙을 의미한다. 그러니까, 연구자가 유죄를 주장하여 본인의 주장이 맞다고 주장하는 가설이 대립가설인 것이다. (X)
4. 귀무가설이란 직접 검증의 대상이 되는 가설로 연구자가 부정하고자 하는 가설이고, 대립가설이란 ​귀무가설에 반대되는 사실로  연구자가 주장하고자 하는 가설이다. (X)
5. 연구자는 귀무가설을 기각하고 싶어한다. (X)
6. 귀무가설은 우리가 증명하고자 하는 가설의 반대되는 가설, 효과와 차이가 없는 가설을 의미하며 우리가 증명 또는 입증하고자 하는 가설, 효과와 차이가 있는 가설을 대립가설이라고 한다. (X)
7. 일반적으로 믿어지는 사실을 귀무가설로 설정하고, 그것을 부정하는 가설을 대립가설로 설정한다. (X)

위와 같은 정의를 따르면, 연구를 할 때 모두 대립가설을 증명하려고 하는 꼴이 되어 버린다. 하지만 귀무가설이 옳다는 것을 증명하고 싶을 때도 있으므로 우리의 의도와 상관없이 귀무가설과 대립가설이 정해져야 한다. 
다시 말해 '증명하려는 명제'와 귀무가설, 대립가설을 정하는 것은 전혀 관계가 없다. 

귀무가설이 맞을 것 같으면 귀무가설을 기각하지 못한다 라고 하고, 귀무가설이 맞지 않을 것 같으면 귀무가설을 기각한다라고 검정한다. 
이 표현은 모든 가설검정은 귀무가설 중심으로 이루어진다는 사실을 보이며,  주의할 점은 검정의 과정에서 귀무가설을 기각하지 못한 경우에도 확률적으로 귀무가설이 틀렸다는 확실한 증거를 찾지 못했다 정도로 해석해야지 귀무가설이 참이라고 확정적인 결론을 내릴 수 없다. 

대립가설은 귀무가설이 기각되었을 때 채택되는 가설이기 때문에 귀무가설과 수학적으로 exclusive하다. 즉, 두 가설의 교집합은 없고 두 가설의 합집합은 전체집합이다. 

## p value 

귀무가설과 대립가설을 세우고 나면, 통계적인 유의성(Significance)과 p value를 고려한다. 예를 들어 어떤 실험을 통해 얻은 그룹 간의 차이가 무작위로 발생할 수 있는 합리적인 수준보다 더 극단적으로 다르다면, 두 그룹의 차이가 우연히 나온 것이 아니라고 접근할 수 있고, 이때 판단 기준이 유의 수준과 p value가 된다. 

p value 유의확률은 귀무가설이 맞다는 가정 아래, 우리가 표본을 통해 관측한 통계 값 또는 관심 있는 통계 값을 포함해서 더 극단적인 값을 관측할 확률을 말한다. 가설검정에서 Significance Probability라고하고 유의확률이라는 표현을 사용한다. 

실제로 p value가 어떻게 계산하는지 예를 들어보자. 회사의 동료중 1명이 너무나 지각을 많이 해서 조금은 주의를 주고 싶었는데, 막상 조사해 보니, 지각하는 시간이 평균 20분이라 하자. 그런데  이 동료가 억울한 나머지, 아무리 생각해도 20분보다는 일찍 오고 있다고 주장하고, 임의의 10일간의 지각 시간을 평균을 내보니 15분을 지각했으니 20분 지각은 아니라고 주장한다. 

아래 데이터는 사장님이 몰래 회사 동료가 입사한 이래 임의의 10일간의 **평균 지각 시간**들을 40개의 데이터로 모아 둔 것이다. 

<p align="center"><img src="https://github.com/user-attachments/assets/9dd0ed41-6e45-49fb-8287-9da0f13dcd71" height="50%" width="50%"></p>

이때 귀무가설 Null Hypothesis는 $\mu \ge 20$이고, 대립가설 Alternative Hypothesis는 $\mu < 20$이다. 따라서 우리가 가정한 분포는 지각 시간이 평균 20이라는 것이다. 

관측된 15분 이하인 경우를 따져보면 전체 40개 중 15분 4개, 13분 1개로 5개가 15분을 포함하면서 더 극단적인 값을 의미한다. 

$\frac{4+1}{40} = 0.125$이므로 이때의 p value는 0.125이다. 다시 말해 12.5% 정도가 15분 이하의 값이다. 

만약 유의수준이 5%라고 하면, 0.125는 0.05보다 크기 때문에 귀무가설의 채택역에 들어가고, 평균이 20분이라는 귀무가설을 기각할 수 없게 된다. 

위의 예를 조금 변형해서 만약 귀무가설이 $\mu = 20$이고, 대립가설이 $\mu \neq 20$로 양측 검정이 되면 p value를 구할 때, 양쪽으로 같은 정도의 관측치와 더 극단적인 값으로 보면 된다. 따라서 왼족으로 15이하, 오른쪽으로 25이상을 보면 40중 5+3으로 p value는 0.2가 된다. 

동전의 예를 한 가지 더 들어보자. 동전을 던졌을 때, 2번이 모두 앞면이 나왔다고 하자. 우리의 귀무가설은 동전이 fair하므로 앞면, 뒷면이 나올 확률이 모두 $\frac{1}{2}$로 같다고 할 수 있다. 정확한 표현은 앞면이 나올 확률 $P(H) = \frac{1}{2}$이 귀무가설이 된다. 따라서 대립가설은 $P(H) \neq \frac{1}{2}$이다. 귀무가설이 참이라 가정하고, 동전을 2번 던졌더니 두 번 모두 앞면으로 관측되었다 하자. 귀무가설이 참이라는 가정아래, 2번 모두 앞면이 나올 확률은 $0.5 \times 0.5 = 0.25$이다. p value를 구하기 위해서 같거나, 더 극단적인 경우를 구해야 하므로 2번 모두 뒷면이 나올 확률도 고려한다. 이외에 더 극단치가 나오는 경우는 없으므로 0이 된다. 
따라서 최종 p value를 구해보면 앞면이 두 번 나올 확률 + 같은 정도의 극단치(뒷면이 두 번 나올 확률) + 앞의 두 값보다 더 극단치가 나올 확률 = $0.25 + 0.25 + 0 = 0.5$가 된다. p value 0.5라는 값은 귀무가설이 참이라는 가정하에 발생할 확률이 매우 큰 경우에 해당되므로, 이 값으로 귀무가설을 기각하기는 어렵다. 

## False Positive & False Negative

p value는 정리하면 관측한 값인 검정 통계량에 근거한 확률을 알아내고 이 값이 크면 귀무가설이 사실일 때 흔히 일어나는 일이니까, 귀무가설을 기각할 근거가 부족해 귀무가설을 채택하고, 거꾸로 p value가 아주 작다는 것은 귀무가설이 사실이라고 했을 때 그만큼 드문 일이라는 뜻으로, 단순한 우연으론 보기 어려우니까, 귀무가설을 받아들이기 어려워서 귀무가설을 기각한다는 의미이다. 

그렇다면 p value를 계산할 때, 관측한 값만으로 계산하는 것이 아니라 더 극단적인 값들을 포함하는 이유가 무엇일까? 
검정만을 위한다면 관측값만 유의수준 $\alpha$와 비교해서 귀무가설을 기각할지 말지 결정할 수 있다. 
가우시안을 예로들어 유의수준이 5%라면 $\alpha$는 1.645.. 일 것이므로 표준화된 관측값이 1.645보다 큰지 작은지만 확인하면 검정이 가능하다. 

p value를 구하는데 극단치를 더 더해서 구하는 이유는, 예를 들어 $\alpha$를 5%로 관리한다고 하면, 가정했던 분포가 무엇이든 앞서 1.645와 같이 해당 분포에서 5%에 해당하는 확률변수값을 구할 필요가 없이 그저 최극단으로부터 5%까지의 **영역**으로 생각할 수 있고, 이 5%와 비교하기 위해 최극단으로부터 관측값까지의 확률값을 구하면 전체의 몇%에 해당하는 확률인지 알 수 있기 때문에 바로 $\alpha$와 비교할 수 있다. 

<p align="center"><img src="https://github.com/user-attachments/assets/55a5de72-baa3-4171-86be-6d7f92bd5330"></p>

추가적으로 $\alpha$와 P value를 확률로 관리하면 또 다른 관점에서의 해석이 가능하다. False Positive, False Negative인데, 
False Positive는 잘못된 긍정으로 없는 것을 있다고 하는 것(잘못된 양성 판정)이다. False Negative는 잘못된 부정으로 있는것을 없다고 하는 것(잘못된 음성 판정)이다. 통계에서는 False Positiv를 더 위험한 것으로 판단한다. 

|Null Hypothesis|$H_0$: True|$H_0$: False| 
|-|-|-|
|Accept the $H_0$|True Negative|Type II Error<br/>$\beta$ Error<br/>False Negative|
|Reject the $H_0$|Type I Error<br/>$\alpha$ Error<br/>False Positive|True Positive|

귀무가설을 잘못 기각하면 1종 오류(Type I Error), 귀무가설을 기각하지 않아서 생기는 오류를 2종 오류(Type II Error)라 한다. 

유의수준이 5%일 때 양측 가설 검정을 수행한다고 하면, 귀무가설이 옳다고 할 때, 양쪽의 2.5% 유의수준보다 바깥쪽의 데이터가 관측되어 귀무가설을 잘못 기각하는 경우(False Positive)는 5%의 확률로 발생한다. 사실상 유의수준 $\alpha$는 False Positive에 의한 위험도의 확률로서의 최댓값이라 할 수 있다. 

$\alpha$가 False Positive 위험도의 확률 최댓값이라 하면, 실제 얼마나 위험한지 알고싶을 때 p value를 사용한다. 검정을 극단치를 더하는 것인 정의인 p value를 통해 검정을 하면, 관측된 검정 통계량에 의한 p value가 5%보다 작을 때, False Positive에 의한 오류의 확률이 5%보다 작아진다. 따라서  p value는 관측된 데이터에 의한 False Positive 위험률의 최댓값이 되는데, p value와 $\alpha$를 비교해서 p value가 작으면 귀무가설을 기각하는데 확률적으로 부담이 적게된다. 

## $z$ test & $t$ test

검정의 예를 $z$검정과 $t$검정을 예로 들어보자. $t$분포는 모분산을 모를 때, 가우시안을 대용해 실제 표본으로 통계적인 접근을 할 수 있는 분포이다. 다음과 같은 경우 $t$검정을 하지 않고, $z$검정을 할 수 있다. 

- 평균을 내기 위해 한번에 추출하는 표본의 크기가 30보다 크다.
- 데이터가 서로 독립적이고, 각각의 데이터는 모집단에서 동일한 확률로 선택된다.(i.i.d)
- 혹은 모분표가 정규분포이다.(다만, 평균을 내기 위한 표본의 크기가 30보다 큰 경우 상관없다.)

위와 같은 조건을 만족하면 중심극한정리에 의해 $z$검정을 할 수 있다. 

과수원에서 매년 100개 포도의 알 수를 적어 두었는데, 전체적으로 평균 75알 표준편차는 15알 이었다고 하자. 올해 과수원에서 100개의 포도를 따서 알 수를 확인했더니 평균 알 수 가 79.5알 이었다고하면, 평균 포도알 수를 75로 하는 것이 타당한지 유의수준 5%에서 검정을 해보자. 

Null Hypothesis는 $\mu=75$, Alternative Hypothesis는 $\mu \neq 75$가 된다. 이때 확률 분포는 중심극한정리에 의해 가우시안이고, 표준편차(표준오차)는 $\frac{\sigma}{\sqrt{n}} = \frac{15}{\sqrt{100}}$이다. Null Hypothesis에 의해 구성된 확률분포는 가우시안이다. Null Hypothesis의 95% 신뢰구간을 추정해 보면, $75 \pm 1.95 \cdot \frac{15}{\sqrt{100}} \to (72.06, 77.94)$이다. 

검정의 관점에서 유의수준 $\alpha$ 5%에 속하는 기각역에 있는지 확인해보자. 79.5알을 목격한 경우의 표준화된 $z$값은 $\frac{79.5-75}{\frac{15}{\sqrt{100}}}=3$이고, 이때의 p value는 0.00135이다. 양측검정이므로 양쪽에 기각역을 각각 2.5%로 설정하고 79.5알을 표준화한 $z$값은 3이므로 p value로 0.00135 = 0.135%이다. 양측검정이므로 $z=-3$ 부터 $-\infty$까지의 값도 0.135%이고, 합은 0.27%이다. 
따라서 귀무가설이 참이라는 가정하에 79.5알이라는 것이 관측(목격)될 확률이 매우 낮음에도 불구하고 관측되었기 때문에, 귀무가설을 기각할 수 있다. 

이제 이 문제를 $t$검정으로 풀어보자. $t$검정을 해야하는 경우는, 모분산으로 몰라서 모분산 대신에 표본분산을 이용하는 경우, 모분포가 가우시안이거나, 중심극한정리를 적용할 수 있는 $n \geq 30$인 경우이다. 

과수원에서 포도의 평균 알 수를 적었는데, 평균 75알이었다. 올해 과수원에서 20개의 포도를 따서 알 수를 확인한 결과 평균 알 수가 79.5였고, 표본의 표준편차는 7알이었다. 이때 표본표준편차 7알은 $n-1$의 자유도=19로 계산된 것이다. 평균 알 수가 75알이어도 될 지 유의수준 5%에서 검정해보자. 

똑같이 Null Hypothesis는 $\mu=75$, Alternative Hypothesis는 $\mu \neq 75$이다. 
중심극한정리에 의한 가우시안이라 하면, $z = \frac{\bar{X} - \mu}{SE} = \frac{\bar{X} - \mu}{\frac{\sigma}{\sqrt{\mu}}}$이고, $t$분포는 닮은꼴로 unknown $\sigma$를 $s$로 치환하면 따르는 분포이므로, $t = \frac{\bar{X} - \mu}{SE} = \frac{\bar{X} - \mu}{\frac{s}{\sqrt{\mu}}}$이다. 이때 표준오차는 $\frac{s}{\sqrt{\mu}} = \frac{7}{\sqrt{20}} = 1.56$이다. 

따라서 목격한 79.5알은 $t_{stat} = \frac{\bar{X} - \mu}{SE} = \frac{\bar{X} - \mu}{\frac{s}{\sqrt{\mu}}} = \frac{79.5-75}{\frac{7}{\sqrt{20}}} = 2.885$, 자유도 $df=20-1=19$이다. $t$분포에서 $t$값이 2.885일 때의 p value를 구해보면 0.0047이다. 0.47%로 간단하게 오른쪽만 보면 2.5%에 비해 매우 작은 값이므로, 75알이 평균이라는 귀무가설을 기각할 수 있다. 






