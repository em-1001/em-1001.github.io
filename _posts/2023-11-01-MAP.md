---
title:  "[Statistics] Maximum Likelihood Estimation"
excerpt: "Likelihood & Maximum Likelihood Estimation"

categories:
  - Statistics
tags:
  - Statistics
toc: true
toc_sticky: true
last_modified_at: 2025-01-19T08:06:00-05:00
---

> 데이터 사이언티스트 되기 책: https://recipesds.tistory.com/  

# Likelihood

확률(Probability)은 모수 $\theta$가 정해진 상태에서 Data가 목격될 가능성을 의미하고, 우도(Likelihood)는 Data가 관측된 상태에서 특정 확률분포의 모수 $\theta$에 대한 믿음의 강도(strength)를 나타낸다. Likelihood와 확률의 관계는 다음과 같다. 

$$\mathcal{L}(\theta; Observation) = P(Observation; \theta) \cdots (*)$$

Likelihood function은 $\mathcal{L}(\theta \vert x)$로 $x$는 이미 정해진 data이다. $\theta$를 특정 값으로 가정하면, Likelihood function은 함수가 아니라 상수가 되어 특정 모수 $\theta$의 분포에 대한 data $x$의 강도를 나타낸다. 가정한 분포에서 관측한 데이터에 대한 높이 $y$가 강도가 되고, 이 강도가 Likelihood이다. 따라서 강도가 높을수록 해당 데이터를 잘 표현하는 모수라 할 수 있다. 

Likelihood는 $\theta \to \mu, \sigma, p$를 Parameter라 할 때, 다음과 같다. 

$$
\mathcal{L}(\theta \vert x) = 
\begin{cases}
P(X=x \vert \theta) & when \ Discrete \ pmf \\  
f(X=x \vert \theta) & when \ Continuous \ pdf   
\end{cases}
$$

<p align="center"><img src="https://github.com/user-attachments/assets/948993e3-b18d-4e71-a5a7-7d63c289612d"></p>

위 Binomial 분포의 그림을 보면 확률은 확률변수인 event가 $x$축인데 반해, Likelihood는 모수 $p$가 변수가 된다. 특적한 event를 fix하고, 모수가 변함에 따라 관측한 데이터가 얼마나 모수에 잘 맞는지에 대한 강도인 Likelihood의 변화를 나타낸다. 


# Maximum Likelihood Estimation(MLE)

최대우도추정(Maximum Likelihood Estimation)은 관측한 데이터를 통해 Parameter모수를 추정하는 방법이다. 
MLE의 특징은 가장 적절한 분포를 먼저 가정하고, 그 가정된 분포에 대한 가장 적절한 모수 $\theta$를 찾는 것인데, $\theta$를 찾는 근거가 Likelihood이다. 따라서 $\theta$에 대한 Likelihood의 최대값을 찾아내면 그때의 $\theta$가 가장 데이터를 잘 설명하는 분포라 할 수 있다. Likelihood의 최대는 미분해서 0이 되는 지점을 찾으면 된다. $\left( \frac{\partial \mathcal{L}}{\partial \theta} = 0 \right)$ 

주머니 안에 검은 구슬과 흰색 구슬이 총 100개 있다고 하자. 10번을 뽑아 보았더니 검은 구슬이 7번, 흰색 구슬이 3번 나왔다. 이때 MLE로 검은 구슬은 전체 구슬 중 몇 개가 있을지 추정해보자. 확률 분포는 Binomial로 정하고, 모수 $\theta$는 $p$가 된다. 검은 구슬이 나오는 사건이 $A$, $n=10$, $p$는 검은 구슬이 나올 확률이라 했을 때, $P(A)$는 다음과 같다.

$$P(A) = \left. \binom{n}{k} \cdot p^k q^{n-k} = C \cdot p^k q^{n-k} \right|_{k=7, n=10} = C \cdot p^7 (1-p)^3$$

$C$는 constant이고, 우리가 추정하는 모수 $\hat{p}$는 아래처럼 Likelihood $P(A)$를 최대화하는 $p$를 구하면 된다. 

$$\hat{p} = arg \max_p(C \cdot p^7 (1-p)^3)$$








