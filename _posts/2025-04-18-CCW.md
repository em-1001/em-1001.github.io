---
title:  "[Algorithm] Point In Polygon"
excerpt: "Point In Polygon test using ccw"

categories:
  - Algorithm
tags:
  - Algorithm
last_modified_at: 2025-04-18T08:06:00-05:00
---

# Point In Polygon

어떠한 점이 다각형 내부에 있는지, 외부에 있는지 판정하는 알고리즘을 알아볼 것이다. 

## CCW(Counter Clock Wise)

CCW는 벡터가 회전하는 방향을 판정하는 알고리즘으로 벡터의 외적을 이용하면 쉽게 구할 수 있다. 

세 점 $a, b, c$가 있을 때, 이 점들을 이용해 벡터 $\vec{ab}, \vec{bc}$를 만든다. 이 두 벡터의 외적값을 이용해 세 점에 대한 방향성을 판정한다. 

우선 3차원에서의 점 $\vec{p} = (p_x, p_y, p_z), \vec{q} = (q_x, q_y, q_z)$가 있을 때 두 벡터의 외적 $\vec{p} \times \vec{q}$는 $\vec{p} \times \vec{q} = (p_yq_z - p_zq_y, p_xq_z - p_zq_x, p_xq_y - p_yq_x)$로 나타낼 수 있고, $\vec{p} \times \vec{q}$의 방향은 오른손 법칙을 따른다. 

2차원에서의 벡터 외적은 3차원에서의 백터 외적에서 $z$좌표만 0으로 두면 된다. 두 벡터 $\vec{p}, \vec{q}$에 대해 $\vec{p} = (p_x, p_y, 0), \vec{q} = (q_x, q_y, 0)$로 나타낼 수 있고, $\vec{p} \times \vec{q} = (0, 0, p_xq_y - p_yq_x)$가 성립한다. 

오른손 법칙에 따라 $\vec{p}, \vec{q}$에 대해 $p_xq_y - p_yq_x$가 양수이면, $\vec{q}$는 $\vec{p}$로 부터 반시계 방향에 있고, 반대로 음수이면 $\vec{q}$는 $\vec{p}$로 부터 시계방향에 있다. 

세 개의 점 $a, b, c$가 주어졌을 때 벡터의 방향성 판단을 정리하면 다음과 같다. 

1. $\vec{ab} \times \vec{bc} > 0$  
$\vec{ab}$에 비교했을 때, $\vec{bc}$의 방향은 반시계 방향이다. (CCW)
2. $\vec{ab} \times \vec{bc} < 0$  
$\vec{ab}$에 비교했을 때, $\vec{bc}$의 방향은 시계 방향이다. (CW)
3. $\vec{ab} \times \vec{bc} = 0$  
점 $a, b, c$는 일직선 상에 위치한다.

CCW에서 정방향은 반시계이기 때문에, 결과가 반시계일 경우 1, 시계는 -1, 직선은 0으로 표현한다. 

c++구현은 다음과 같다. 

```cpp
typedef long long ll;
typedef pair<ll, ll> pll;

int ccw(pll a, pll b, pll c) {
    ll v1_x = b.X - a.X;
    ll v1_y = b.Y - a.Y;
    ll v2_x = c.X - b.X;
    ll v2_y = c.Y - b.Y;
    
    ll cross = v1_x * v2_y - v1_y * v2_x;
    
    if(cross > 0) return 1;
    if(cross < 0) return -1;
    return 0; 
}
```




