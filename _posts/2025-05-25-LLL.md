---
title:  "LLL Algorithm"
excerpt: "LLL Algorithm"

categories:
  - cryptography
tags:
  - Algorithm
  - cryptography
last_modified_at: 2025-04-18T08:06:00-05:00
---

## LLL reduction

**Definition.** (LLL-Reduced Basis) $\mathcal{L}$의 기저 $B$와, 그것을 Gram-Schmidt한 기저 $B^* $ 을 생각하자. (이 때, 물론 $B^* ⊂ ℝ^n$이다.) $B$와 $B^*$가 다음 조건을 만족한다면, $B$를 $$\mathcal{L}$$의 LLL-Reduced Basis라고 한다.

1. (Size Condition.) $\vert \mu_{i,j} \vert = \left\lvert \frac{\langle b_i, b_j^* \rangle}{\lVert b_j^* \rVert^2} \right\rvert \leq \frac{1}{2}$
2. (Lovasz Condition.) $\lVert b_{i+1}^* + \mu_{i+1, i}b_i^* \rVert^2 \geq \delta\lVert b_i^*\rVert^2　\delta \in \left(\frac{1}{4},1\right)$

Size Condition부터 살펴보면 Gram-Schmidt 계수 $\mu_{i,j}$는 $b_j^*$와 $b_i$ 사이의 각을 측정한다. 만약 $μ$가 1에 가까워 지면 각은 작아지고, $μ$가 0에 가까워 지면 각이 커지며 orthogonal에 근접한다. 따라서 Size Condition은 LLL-Reduced Basis가 orthogonal에 근사하도록 하는 조건임을 알 수 있다. 

이제 Lovasz Condition을 살펴보자. 우린 LLL Algorithm을 통해 최단 벡터를 찾는 것이 목적이기 때문에, 앞쪽 벡터가 짧아야 전체 격자에서 더 빠르게 최단 벡터를 찾을 수 있다. 따라서 우리가 원하는 벡터 정렬 순서는 다음과 같다. 

$$\lVert b_i \rVert \leq \lVert b_{i+1} \rVert$$

하지만 모든 $i$에 대해 위 조건을 만족하려면 알고리즘을 다항시간 내에 끝낼 수 없다. 또한 앞서 Size Condition을 보면 만약 $b_j^*$가 $b_i$에 비해 충분히 길면 각도와 상관없이 조건을 만족할 수도 있다. Lovasz Condition은 이 두 가지를 고려하며, $\delta$는 주로 $\frac{3}{4}$를 쓴다. 

$$
\begin{aligned}
\lVert b_{i+1}^* + \mu_{i+1, i}b_i^*\rVert^2 &= \lVert b_{i+1}^*\rVert^2 + \mu_{i+1, i}^2 \lVert b_i^*\rVert^2 \\  
\lVert b_{i+1}^*\rVert^2 + \mu_{i+1, i}^2 \lVert b_i^*\rVert^2 &\geq \frac{3}{4} \lVert b_i^*\rVert^2 \\ 
\lVert b_{i+1}^*\rVert^2 &\geq \left( \frac{3}{4} - μ_{i+1, i}^2 \right)\lVert b_i^*\rVert^2 \\  
&\geq \frac{1}{2}\lVert b_i^*\rVert^2
\end{aligned}$$

결국 $\lVert b_ {i+1}^* \rVert^2 \geq \frac{1}{2}\lVert b_ i^* \rVert^2$ 조건을 통해 $b_{i+1}^* $의 길이가 $b_i^* $의 길이보다 아주 짧을 수는 없게 하여 Size Condition문제를 해결하고, 앞서 보았던 $\lVert b_i \rVert \leq \lVert b_{i+1} \rVert$ 벡터 정렬 순서를 조금 완화하여 벡터들의 순서를 어느정도 강제하면서 다항시간 $O(d^5n \log^3 B)$안에 해결될 수 있도록 한다. 

위 관계를 통해 $\delta > \frac{1}{4}$이어야 함을 알 수 있고, 만약 $\delta=1$이 되면 최종적으로 $\lVert b_ {i+1}^* \rVert^2 \geq \frac{3}{4}\lVert b_ i^* \rVert^2$ 가 되어 벡터 정렬 순서를 조금 더 강제한다.   

LLL이 다항시간 안에 종료됨의 증명은 [Polynomial time proof](https://cryptohack.gitbook.io/cryptobook/lattices/lll-reduction/lll-reduced-basis#polynomial-time-proof)를 참고하자. 

정리하면 LLL-Reduced Basis는 다음과 같은 성질을 갖는다. 
1. Short  
각 기저 벡터들이 원래 벡터보다 짧아지며, 특히 첫 번째 벡터는 매우 짧으므로 우리가 원하는 짧은 해 또는 작은 정수 해를 잘 근사한다.
2. Approximately Orthogonal  
Gram-Schmidt 직교화 과정을 통해 벡터 간의 직교성을 높여 완전한 직교는 아니지만, "선형 독립성이 잘 보존된 방향"으로 기저를 조정한다.
3. Same Lattice Span  
LLL reduction은 기저 벡터들에 대해 정수 계수로만 변형을 가해 원래 basis와 같은 Span 즉, 같은 Lattice를 생성한다. 

## LLL Algorithm

LLL reduction의 조건에 따라 LLL Algorithm은 다음과 같이 동작한다. 

**Definition.** (LLL Algorithm.) 다음 알고리즘은 임의의 기저 $B$를 LLL-Reduced Basis로 변환한다.

1. Gram-Schmidt Orthogonalization을 근사한다. ($\mu_{i, j}$ 대신 $⌈\mu_{i, j}⌋$을 사용해서.)
2. 모든 $i$에 대해서 Lovasz Condition을 확인한다. 이 때,  
+ 조건을 만족한다면 종료한다.  
+ $b_{i}^* $와 $b_{i+1}^* $가 조건을 만족하지 않는다면, $b_{i}$와 $b_{i+1}$의 순서를 바꾼 뒤(swap), 1번으로 돌아간다.

알고리즘의 Step 1을 거치면 Size Condition이 만족되고, Step 2를 거치면 Lovasz Condition이 만족된다. 







  
