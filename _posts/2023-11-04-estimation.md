---
title:  "[Statistics] Statistical Estimation"
excerpt: "Statistical Estimation"

categories:
  - Statistics
tags:
  - Statistics
toc: true
toc_sticky: true
last_modified_at: 2025-01-19T08:06:00-05:00
---

> 데이터 사이언티스트 되기 책: https://recipesds.tistory.com/

# Estimation

통계적 추론은 표본을 통해 모집단에 대한 추론을 하는 과정을 말한다. 추정(Estimation)은 표본을 이용해 모수(Parameter, $\theta$)를 
어떠한 값으로 추측하는 과정으로서 추정값(점추정) 또는 추정 값의 범위를 이용해 모수를 추정하는데, 이때 추정 값의 범위를 오차범위(표본오차, 신뢰구간) 등으로 제시한다.   
가설검정은(Hypothesis Testing)은 표본을 이용해 모집단에 대한 주장을 하거나, 주장하는 가설이 모집단에 대해 옳거나 그르다고 판단하는 과정으로 
이 과정에서 가설이 귀무가설(Null Hypothesis), 대립가설(Alternative Hypothesis)로 제시된다. 
통계에서는 추정을 하기 때문에 검정을 할 수 있고, 검정이 가능하기에 통계적 결론을 낼 수 있다. 

주어진 신뢰도로 표본들이 어디에 있을지 추정하는 통계 추정의 간단한 예를 들어보면, $\mu=200, \sigma=1$인 가우시안 분포의 모집단이 있다고 할 때, 
무작위로 표본을 뽑으면 관측될 표본의 95%가 어느 구간에 있을지 예측해보자. 가우시안에서 95%의 데이터가 들어있는 구간은 $\mu$로부터 $-1.96\sigma ~ +1.96\sigma$로서
 1.96은 95%에 대한 critical value로, 보통 한쪽 구역에서 2.5%를 의미하니까, $z_{2.5\%}$라 표현한다. (2.5%가 양쪽에 있으니, 합쳐서 신뢰도 95%이다.)
결과적으로 $\sigma=1$이니까, $200 - 1.96 \cdot 1 ~ 200 + 1.96 \cdot 1$사이에 95%의 표본이 관측된다. 참고로 신뢰도 99%일 때는 임계값 $z_{0.5\%}$가 2.58이고, 
임계값을 일반형으로 표기할 때는 $z_{critical}$로 표현한다. 

이제 본격적인 모평균 추정에 앞서 평균, 분산에 대한 notation을 정리하면 다음과 같다. 

|집단|평균|분산|표준편차|
|-|-|-|-|
|모집단|$m$|$\sigma^2$|$\sigma$|
|표본집단|$\bar{X}$|$s^2$|$s$|
|표본평균의 집단|$E(\bar{X})$|$\frac{\sigma^2}{n}$|$\frac{\sigma}{\sqrt{n}}$|

마지막 표본평균의 집단은 중심극한정리에 의한 값이다. 

<p align="center"><img src="https://github.com/user-attachments/assets/fc3ceffa-4cde-4016-a165-d58160dab99d"></p>

어떤 $\bar{X}$를 관측했는데, 그 값이 중심극한정리에 의해서 가우시안 분포에서 나온 값이고, 해당 값이 가우시안 분포의 어디에 위치하는지 계산하기 위해 관측값을 $Z$값으로 표준화 한다. 

예를 들어 온도를 측정하는데 온도계로 30번 측정했더니($n=30, N=1$), 평균이 20도 였다고 하면, 95%의 신뢰도로 모평균 온도 구간을 추정해보자. 이때, 표본평균은 가우시안 분포를 하고, 표준오차가 5라고 가정하자. 우리는 표본으로 20도를 관측했으므로, 20도가 신뢰구간 안에 포함되어야 한다. 따라서 upper bound는 20도 보다 커야하고, lower bound는 20도 보다 작아야 한다. 

$$\mu + 1.96 \cdot 5 \geq 20$$

$$\mu - 1.96 \cdot 5 \leq 20$$

위 두 부등식을 만족하는 구간은 $10.2 \leq \mu \leq 29.8$이고, 따라서 이 구간에 평균이 있을 확률이 95%가 된다. 

예시를 한가지 더 들어서 4개의 데이터를 관측했을 때, 이 4개의 데이터의 평균은 200, 표준편차는 10이라 하자. 모평균을 95% 신뢰도로 추정한다고 하면, $\bar{X}=200, \sigma=10, n=4$이므로, 중심극한정리에 의해 모평균은 $\mu$를 중심으로 $\pm1.96\frac{\sigma}{\sqrt{n}}$이다. 따라서 표본에서 관측한 평균 200은 이 구간 안에서 관측되면 된다. 

$$\mu + z_{2.5\%} \frac{10}{\sqrt{4}} \geq 200$$

$$\mu - z_{2.5\%} \frac{10}{\sqrt{4}} \leq 200$$

$z_{2.5\%}$는 앞서 말했듯이 95% 신뢰도를 위한 가우시안 오른쪽 2.5%에서의 값으로 1.96이다. 

이상한 점이 있는데, 이 예시에서 우리는 관측한 표본의 표준편차만 알고, 모집단의 분산을 알지 못한다. 
따라서 위와 같은 계산은 표본 평균이 완벽한 정규분포를 이룬다는 가정 하에 구할 수 있는 신뢰구간 추정량이 된다. 

일반적으로 우리는 모평균을 추정할 때, 모표준편차를 알지 못한다. 따라서 $s$(표본표준편차)로 대치하면 $t$분포가 된다는 점을 이용한다. 
분산의 불편 추정량(표본분산 $s^2$)을 사용하는 표본평균의 분포는 가우시안과 닯은 $t$분포가 된다. 
이때는 통계량 $\frac{\bar{X} - \mu}{\frac{s}{\sqrt{n}}}$이 $t$분포를 따른다. 이는 표본 평균의 표준편차가 $\frac{s}{\sqrt{n}}$이기 때문에, $z$분포에서 표준편차 $\sigma$만 표본표준편차 $s$로 바꾼 것이다. 

결과적으로 위 예시의 경우  $t$분포에서 분산의 불편추정량을 이용해 평균을 추정하고, 자유도는 당연히 $n-1$이다. 

불편추정량을 이용해 모분산을 대신하게 되면 $\frac{\sigma^2}{n}$가 $\frac{s^2}{n}$가 된다. 
여기서 $s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2$로, $n-1$자유도로 표본분산을 계산한다. 

따라서 $t$분포를 이용하면 모평균으로부터 $\pm t_{2.5\%, dof}\frac{s}{\sqrt{n}}$ 사이에 관측값이 있으면 된다. 

예를 들어, 어떤 모집단에서 표본 500개를 추출해서 표본 평균이 100,000이 나왔고, 표본 분산이 2,000,000이 나왔다고 한다면 

$$\mu + t_{2.5\%, 499} \frac{\sqrt{2000000}}{\sqrt{500}} \geq 100000$$

$$\mu - t_{2.5\%, 499} \frac{\sqrt{2000000}}{\sqrt{500}} \leq 100000$$

을 만족하는 범위를 찾으면 된다. 여기서 $t_{2.5\%, 499}$는 자유도($n-1$)이 499, 확률이 2.5%인 $t$값을 의미하고, 자유도와 유의수준에 따른 해당 값은 t분포표에서 찾을 수 있다.

정리하면 모집단 평균의 구간 추정을 할 때, $\sigma$가 알려지지 않은 경우(현실세계)  $s$를 $\sigma$의 추정치로 사용하고 $\mu$의 구간 추정은 $t$분포에 기초한다고 할 수 있다. 이때 자유도가 30을 초과하면, $t$값은 정규분포 $z$의 값과 거의 같아지기 시작한다. 따라서 정규분포 $z$는 $t$ 테이블의 무한 자유도 값으로 대치할 수 있다. 

##  Estimating Proportions

앞서 평균의 구간 추정을 해봤다면, 이젠 모비율의 구간 추정을 해볼 것이다. 모비율을 추정한다는 것은 표본비율을 가지고 모비율을 추정한다는 것으로, 비율인 $p$에 대해 $p$와 $1-p$로 어떤 현상을 설명하는 Binomial분포를 이용한다. Binomial는 $n$개의 확률변수가 어떤 확률 분포를 따르는지에 상관없이 $n$이 충분히 크다면 그 합은 가우시안을 따른다는 중심극한정리에 의해 Bernoulli의 성공횟수의 합을 확률변수로 가지므로 가우시안으로 근사된다. 

$$X \to P(X=x) \sim B(n, p) \approx N(np, np(1-p))$$

이때 주의할 점은 $p$는 구하고자 하는 모수이기 때문에 조사한 표본의 비율로 바꿀 수 없지만, 분산은 $n$이 충분히 크기 때문에 표본분산을 모분산으로 대체할 수 있다. 

예를 들어 600가구를 대상으로 현재 시청하는 채널을 조사했더니, 99가구가 KBS를 보고 있었다고 할 때, 진짜 KBS의 시청율을 95%의 신뢰구간으로 추정해보자. $\hat{p} = \frac{99}{600}$이다. 여기서 $\hat{p}$는 관측했다는 뜻이다. 따라서 가우시안으로 근사하면 다음과 같다.

$$B(n, p) \approx N(np, n\hat{p}\hat{q}) = N(600p, 600 \cdot \frac{99}{600} \cdot \frac{501}{600})$$

따라서 $600p \pm 1.96 \cdot \sqrt{600 \cdot \frac{99}{600} \cdot \frac{501}{600}}$ 사이를 95% 구간으로 볼 수 있다. 
이제 평균 추정과 마찬가지로 관측한 99가 위 구간에 포함되야 하므로, 

$$600p + 1.96 \cdot \sqrt{600 \cdot \frac{99}{600} \cdot \frac{501}{600}} \geq 99$$

$$600p - 1.96 \cdot \sqrt{600 \cdot \frac{99}{600} \cdot \frac{501}{600}} \leq 99$$

이다. 따라서 $p$는 $\frac{99}{600} \pm 1.96 \frac{\sqrt{600 \cdot \frac{99}{600} \cdot \frac{501}{600}}}{600}$ 구간이 95% 신뢰구간이 된다. $0.165 \pm 0.0297$

이러한 모비율 추정을 공식화 하면 원래 $X \sim B(n, p)$인 것을, $X$를 $n$으로 나눠서 비율로 다시 표현하면 $\hat{p} = \frac{X}{n}$이 된다. 표본비율이 $n$개의 표본 중 $X$개를 차지한다고 보면, $X \sim B(n, p) \approx N(np, n\hat{p}\hat{q})$ 이므로, 

$$\hat{p} = \frac{X}{n} \sim N \left( p, \frac{\hat{p}\hat{q}}{n} \right)$$

가 된다. 이유는 $E(\hat{p}) = E\left( \frac{X}{n} \right) = \frac{np}{n} = p$ 이고, $Var(\hat{p}) = Var \left(\frac{X}{n} \right) = \frac{n \hat{p} \hat{q}}{n^2} = \frac{\hat{p} \hat{q}}{n}$ 이기 때문이다. 

따라서 $\hat{p}$는 $N(p, \frac{\hat{p} \hat{q}}{n})$를 따르고, 정규화 하면 $\frac{\hat{p} - p}{\sqrt{\frac{\hat{p} \hat{q}}{n}}}$이 근사적으로 표준 정규분포를 따른다. 

최종적으로 모비율 추정을 공식화하면 다음과 같다. 

$$P \left( -z_{critical} \leq \frac{\hat{p} - p}{\sqrt{\frac{\hat{p} \hat{q}}{n}}} \leq z_{critical} \right) \to P \left( \hat{p}-z_{critical}\sqrt{\frac{\hat{p} \hat{q}}{n}} \leq p \leq \hat{p}+z_{critical}\sqrt{\frac{\hat{p} \hat{q}}{n}}  \right)$$ 








